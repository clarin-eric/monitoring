object CheckCommand "check-ssl" {
	//Name des Kommandos
	import "plugin-check-command"
	command = [ "/etc/icinga2/conf.d/sites/dariah/probes/check-ssl" ]
	//Hier den Dateinamen des Plugins angeben
	arguments = {
		"key" = {
			value = "$address$"
			skip_key = true
		}
		//Hier werden die vom Plugin benötigten Parameter angegeben
	}
}

object CheckCommand "check-ssl-lifetime" {
	//Name des Kommandos
	import "plugin-check-command"
	command = [ PluginDir + "/check_http" ]
	//Hier den Dateinamen des Plugins angeben
	arguments = {
    		"--ssl" = ""
    		"-C" = "30,14"
    		"-H" = "$address$"
		//Hier werden die vom Plugin benötigten Parameter angegeben
    		"--sni" = ""
	}
}

object CheckCommand "http_header" {

        import "plugin-check-command"
	command = [ PluginDir + "/getopt" ]
	arguments = {
		"-S" = { set_if = "$http_ssl$" }
		"-H" = "$http_vhost$"
		"-k" = "$http_header$"
		"-s" = "$http_string$"
		"-u" = "$http_uri$"
	}
}

object CheckCommand "nrpe-check-1arg" {
        import "plugin-check-command"
        command = [PluginDir + "/check_nrpe" ]
        arguments = {
        "-H" = "$address$"
        "-c" = "$check$"
        "-t" = "60"
        }
}

object CheckCommand "check_shib_cert" {
	//Name des Kommandos
	import "plugin-check-command"
	command = [ "/etc/icinga2/conf.d/sites/dariah/probes/shibsp-certificate.sh" ]
	//Hier den Dateinamen des Plugins angeben
	arguments = {
		"key" = {
			value = "https://$address$/shibboleth"
			skip_key = true
		}
	}
}

object CheckCommand "check_idp" {

        import "plugin-check-command"
	command = [ "/etc/icinga2/conf.d/sites/dariah/probes/check-idp" ]
	arguments = {
		"key0" = {
			value = "/etc/icinga2/conf.d/sites/passwords/dariah-idp-testuser2.txt"
			skip_key = true
		}
		"key1" = {
			value = "$sp_url$"
			skip_key = true
		}
		"key2" = {
			value = "$idp_url$"
			skip_key = true
		}
		"key3" = {
			value = "$resource_url$"
			skip_key = true
		}
		"key4" = {
			value = "$string$"
			skip_key = true
		}


	}
}

