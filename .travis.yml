language: python

before_install:
  - sudo add-apt-repository -y ppa:formorer/icinga
  - sudo apt-get update -qq
  - sudo apt-get install -y icinga-core

before_script:
  - mkdir -p lib/spool lib/rw run/icinga cache/icinga lib/icinga/spool/checkresults lib/icinga/rw log/icinga
  - sed -i "s/\/etc\/icinga\/resource.cfg/clarin\/resource.cfg/g" icinga.cfg
  - sed -i "s/\/var\///g" icinga.cfg
  - echo '$USER1$=/usr/lib/icinga/plugins' > resource.cfg

script: /usr/sbin/icinga -v icinga.cfg

notifications:
  webhooks: http://clarin.fz-juelich.de:7010/hook/